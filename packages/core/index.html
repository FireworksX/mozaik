<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Time travel</title>
  </head>
  <body>
    <div id="app">
      <h1>{{ userStore.name }}</h1>
    </div>

    <script src="build/mozaikjs.umd.js"></script>
    <script>
      const { types, onSnapshot } = core

      const userStoreModel = types
        .model({
          name: types.maybe(types.string)
        })
        .actions({
          setName({ dispatch }, name) {
            dispatch({
              name
            })
          }
        })

      const userStoreInstance = userStoreModel.create({
        name: 'arthur'
      })

      const rootStoreModel = types
        .model('rootStore', {
          msg: types.string,
          list: types.array(types.string),
          userStore: userStoreModel
        })
        .actions({
          inputText({ dispatch }, value) {
            dispatch({
              msg: value
            })
          },
          addTodo({ dispatch, state }) {
            dispatch({
              list: [...state.list, state.msg]
            })
          }
        })
        .create({
          msg: 'arthur',
          list: [],
          userStore: userStoreInstance
        })

      onSnapshot(rootStoreModel, console.log)

      rootStoreModel.addTodo()
      rootStoreModel.addTodo()
    </script>
  </body>
</html>
